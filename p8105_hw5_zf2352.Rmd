---
title: "p8105_hw5_zf2352"
author: "Zhenkun Fang"
date: "2024-11-11"
output: github_document
---

```{r setup, include=FALSE}
library(tidyverse)
knitr::opts_chunk$set(echo = TRUE)

set.seed(123)
```

# Problem 1

```{r}
duplicated_birthday = function(n) {
  
  birthdays = sample(1:365, n, replace = TRUE)
  
  return(length(birthdays) != length(unique(birthdays)))
}

duplicated_birthday(25)
```

```{r}
group_size = 2:50
probabilities = numeric(length(group_size))
simulations = 10000

for (i in seq_along(group_size)) {
  n = group_size[i]
  duplicates = replicate(simulations, duplicated_birthday(n))
  probabilities[i] = mean(duplicates)
}

results <- data.frame(GroupSize = group_size, Probability = probabilities)
print(results)
```

```{r}
plot(group_size, probabilities, type = "o", col = "blue",
     xlab = "Group Size", ylab = "Probability of Shared Birthday",
     main = "Probability of at Least Two People Sharing a Birthday")
```

The plot shows that as the group size increases from 2 to around 23, the probability of at least two people sharing a birthday increases rapidly. At a group size of approximately 23, the probability exceeds 0.5, meaning that there's a greater than 50% chance that at least two people will share a birthday. The plot shows a steady increase in probability up to around group size 40, after which the probability seems to plateau near 1.

# Problem 2

